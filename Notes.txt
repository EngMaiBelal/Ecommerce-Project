0- create Project 
    - open command prompt
    - composer create-project laravel/laravel example-app
    - cd example-app
    - code .
    - php artisan serve

1- create db
    - phpMyAdmin
    - .env configuration

2- Migration at first for parant table 
    - php artisan make:migration create_categories:table
    - write in file migration all attributes in this table
    - write also forien key if exists
    - php artisan migrate
    - php artisan migrate:status

3- add column for custom table
    - php artisan make:migration add_phone_to_categories:table
    - write in this file syntax of D.T
    - php artisan migrate
    - php artisan migrate:status

4- create all models for tables 
    - php artisan make:model Admin
    - class User must be inherite Authenticatable
    - protected $fillable = [ all column that will be fill any time ];
    - protected $guarded  = [ all column that will not be fill any time ];
    - protected $hidden   = [ ex password, remember_token];
    - protected $casts    = ['email_verified_at' => 'datetime']; هتعامل معاه ازاي الديفلوبر وهوه محافظ علي اسمه في الداتا بيز عادي
    - Write all relationships  ex:  addresses().

5- Multi Authentication 
    - download node module  in my laptop
    - composer require laravel/breeze  
    - php artisan breeze:install    
    - npm install       
    - npm run dev 
    - Test Auth cycle
        - add phone in controller register & views.
    - Model (admin, user, seller) must implements MustVerifyEmail & extends Authenticatable
    - Write the MailTrap configuration in .env.
    - Edit in config > auth.php  file.
        - 'defaults' => ['guard' => 'web', 'passwords' => 'users']

        - 'guards' => [
                'web'   => [ 'driver' => 'session', 'provider' => 'users' ],
                'admin' => [ 'driver' => 'session', 'provider' => 'admins'],
                'seller'=> [ 'driver' => 'session', 'provider' => 'sellers']
        ],

        - 'providers' => [
            'users'   => [ 'driver' => 'eloquent', 'model' => App\Models\User::class],
            'admins'  => [ 'driver' => 'eloquent', 'model' => App\Models\Admin::class],
            'sellers' => [ 'driver' => 'eloquent', 'model' => App\Models\Seller::class],
        ],

        - 'passwords' => [
            'users'   => [ 'provider' => 'users'   , 'table' => 'password_resets'       , 'expire' => 60, 'throttle' => 60],
            'admins'  => [ 'provider' => 'admins'  , 'table' => 'admin_password_resets' , 'expire' => 60, 'throttle' => 60],
            'sellers' => [ 'provider' => 'sellers' , 'table' => 'seller_password_resets', 'expire' => 60, 'throttle' => 60],
        ]

    2- migration 
            - copy from create_password_resets and make two table
                1- create_seller_password_resets
                2- create_admin_password_resets

6- edit routes 





------------------------------------------------------------------------------------------------------
// ********* multi auth ********* //
------------------------------------------------------------------------------------------------------

1- abstract class auth implements 4 interface in contracts folder 
    a- AuthenticatedSessionController
        1- Generate New namespace.

        2- abstract class AuthenticatedSessionController extends Controller  implements
            GuardInterface,
            RouteNamePrefixInterface,
            ViewPrefixInterface

        3- Replacements
                1- return view('auth.login');
                return view($this->getViewPrefix(). 'auth.login');
        
                2- $request->authenticate();
                $request->authenticate($this->getGuard());

                3- return redirect()->intended(RouteServiceProvider::HOME); >>>> public const HOME = '/dashboard';
                return redirect()->route($this->getRouteNamePrefix() . 'dashboard');
        
                4- Auth::logout();
                Auth::guard($this->getGuard())->logout();

                5- return redirect('/');
                return redirect()->route($this->getRouteNamePrefix() . 'login');
    b- ConfirmablePasswordController extends Controller implements
        1- ViewPrefixInterface, GuardInterface, RouteNamePrefixInterface
        2- Replacements:- 
            - view($this->getViewPrefix() . 'auth.confirm-password');
            - Auth::guard($this->getGuard())......
            - ..... $request->user($this->getGuard())->email,....
            - return redirect()->route($this->getRouteNamePrefix() . '.dashboard');
    c- EmailVerificationNotificationController extends Controller 
        1- implements GuardInterface, RouteNamePrefixInterface
        2- Replacements:- 
        
            - $request->user($this->getGuard()) .... 
            - redirect()->route($this->getRouteNamePrefix() . 'dashboard');
            - $request->user($this->getGuard()) ....
    d- EmailVerificationPromptController 
        1- implements GuardInterface, RouteNamePrefixInterface, ViewPrefixInterface

        2- Replacements:- 
            - $request->user($this->getGuard()) .....
            - redirect()->route($this->getRouteNamePrefix() . '.dashboard')
            - view($this->getViewPrefix().'auth.verify-email');
    e- abstract class NewPasswordController extends Controller 
        1- implements RouteNamePrefixInterface, ViewPrefixInterface, BrokerInterface
        2- Replacements:- 
            - view($this->getViewPrefix() . 'auth.reset-password'.......
            - Password::broker($this->getBroker())->reset(......
            - ? redirect()->route($this->getRouteNamePrefix() . 'login')....         
    f- PasswordController
        1- implements GuardInterface
        2- Replacements:- 
            - $request->user($this->getGuard())......         
    g- PasswordResetLinkController
        1- implements ViewPrefixInterface, BrokerInterface
        2- Replacements:- 
            - $this->getViewPrefix() . 'auth.forgot-password');
            - Password::broker($this->getBroker())......
    h- RegisteredUserController 
        1- implements ViewPrefixInterface, GuardInterface, RouteNamePrefixInterface, ModelInterface
        2- Replacements:- 

            - view($this->getViewPrefix() . 'auth.register');
            - $user = $this->getModel()::create([
            - Auth::guard($this->getGuard())->login($user);
            - return redirect()->route($this->getRouteNamePrefix() . 'dashboard');
    i- VerifyEmailController 
        1- implements GuardInterface, RouteNamePrefixInterface
        2- Replacements:- 
            - $route = route($this->getRouteNamePrefix() . 'dashboard') . '?verified=1'; # url . ?verified=1
            - if ($request->user($this->getGuard())->hasVerifiedEmail()) { return redirect($route); }
            - if ($request->user($this->getGuard())->markEmailAsVerified()) { event(new Verified($request->user($this->getGuard())));}
            - return redirect($route);
    h- move ProfileController in Auth folder
        
        1- implements GuardInterface, RouteNamePrefixInterface, ViewPrefixInterface
        2- Replacements:- 
            - view($this->getViewPrefix() . 'profile.edit', [
            - $request->user($this->getGuard()).... 6 times
            - Redirect::route($this->getRouteNamePrefix().'profile.edit')->with('status', 'profile-updated');
            - Auth::guard($this->getGuard())->logout();
            - Redirect::route('welcome'); -->  return Redirect::to('/');
2- User/ Seller /Admin folder >> Auth 
    a- implements the properties and set(), get() methods
    b- ex:- 
        private $guard = "seller";
        private $model = Seller::class;   
        private $viewPrefix = 'seller.';   
        private $routeNamePrefix = 'sellers.';

        public function getGuard() :string { return $this->guard; }
        public function setGuard(string $guard) :void { $this->guard = $guard; }

    c- override method store if you need
            - 'email' => ['required', 'string', 'email', 'max:255', 'unique:'.$this->getModel()],


3- routes
    - put RouteName for ('welcome') -> name('welcome');
    - we use 3 middleware
        1- middleware('guest')                      -> 'register', 'login', 'forgot-password', 'reset-password'
        2- middleware('auth:web')                   -> 'verify-email', 'verify-email/{id}/{hash}', 'email/verification-notification', 'confirm-password', 'confirm-password', 'password', 'logout'
        3- middleware(['auth:web', /*'verified:web'*/]) -> dashboard, profile
    - view('user.dashboard')
    - name('users.-----')
    - namespace
4- views
    - replace route('logout') ----> route('users.logout')
    - replace Auth::user()    ----> Auth::guard('web')->user()
    - replace @include()      ----> @include('user.')

    
1- problem (verification.verify)
    - verification.email
        \vendor\laravel\framework\src\Illuminate\Auth\Notifications\VerifyEmail.php
        
    - Route::get('verify-email/{id}/{hash}', [VerifyEmailController::class, '__invoke'])
        ->middleware(['signed', 'throttle:6,1'])->name('verification.verify');  // make user verified
    
    - The user model implement interface mustVerifyEmail abstract method without implements that contains the method
    but i notice the method not implementation in the model 
    but in trait \vendor\laravel\framework\src\Illuminate\Auth\MustVerifyEmail.php
    
    - the method --> sendEmailVerificationNotification()
        $this->notify(new VerifyEmail); --> $this->notify(new VerifyUserEmail);
    - make notification 
        php artisan make:notification VerifyUserEmail 
        Replace 'verification.verify' to 'users.verification.verify'

2- problem (verification.notice)
    - انا مش عارف احدد انهي middleware 'verified:web' ??

    - Route::get('verify-email', [EmailVerificationPromptController::class, '__invoke'])
                    ->name('verification.notice'); // return email view
    
    - \vendor\laravel\framework\src\Illuminate\Auth\Middleware\EnsureEmailIsVerified.php
    الراوت استاتيك هنا في الفيل ده 
    ده الميدلوير الللي لارقل بتستخدمه عشان تشيك اليوزر فريفاي والا لا

        - هنقله في الابلكيشن Middleware المصفه filterion http requests  عن طريقif
        - وال kernel.php هغير باصص فين registered it 
            - 'verified' => \App\Http\Middleware\EnsureEmailIsVerified::class,
        - 3 Auth Middleware    
            - auth     ----> login 
            - verified ----> verified
            - guest
        - php artisan make:Middleware EnsureEmailIsVerified
        -  هنا الراوت استاتيك وانا عاوز اخليه لليوزر والسيلر مش عاوز اعمل اتنين ميدل وير اعمله برامتر
        - steps:-
            - make private array $routeGuardMap = ['web'=>'users.', 'seller'=>'sellers.'];
            - getRouteGuardMap($guard) --> handle if developer write seller, admins, ....... , any wrong route
            - add parameter handle($request, Closure $next, $guard = null, $redirectToRoute = null)
            - replace $request->user() --> $request->user($guard) ||
            - : $this->getRouteGuardMap($guard).'verification.notice')); // user or seller

3- problem (password.reset)
    - route static where  ????  ---> in \vendor\laravel\framework\src\Illuminate\Auth\Notifications\ResetPassword.php
    - I estimate (password.reset) is Class Notification
        I make same class notification in my app & change the static route
    - invoke it where     ????  ---> in \vendor\laravel\framework\src\Illuminate\Auth\Passwords\CanResetPassword.php
        sendPasswordResetNotification($token)
    - overwrride it where ????  ---> in User Model
        replace (new ResetPasswordNotification($token)) ---> (new ResetUserPassword($token))

- note:-
    الميدل وير اللي بتكون حاطه ع اي حاجه لازم تكون عارف الجارد عشان تكون عارف هتريديركت ع فين

4- problem how to make dynamic route in 2 notification class

how to get guard from model
    1- ممكن من فيل ال config
    2- معتمد علي مين عامل لوجن حاليا وممكن من نفس البراوزر اقدر ادخل يوزر وادمن وسيلر 
    فالفانكشن بتاعت سعد هتجبلي اول جارد عامل لوجن وخلاص فمستفدتش

    $guards = array_keys(config('auth.guards'));
    foreach ($guards as $guard){
        if(Auth::guard($guard)->check()) ......
    }


    3- dd($notifiable); return model user
    3- dd(config('auth.guards')); 
        return array:4 [▼ // routes\web.php:22
            "web" => array:2 [▶]
            "admin" => array:2 [▶]
            "seller" => array:2 [▶]
            "sanctum" => array:2 [▶]
        ]
مش انسب حاجه لانه معتمد ان اسم البروفايدر لازم نفس اسم التابل

- getGuardFromProvider(string $provider) :?string
        - foreach ( config('auth.guards') as $guard => $values)
        - if( $values['provider'] === $provider) --> return $guard
                                           ifnot --> return null

- getProviderFromModel(Model $model) :?string
        - foreach ( config('auth.providers') as $provider => $values)
        - if( $model instanceof $values['model'] ) --> return $provider
                                                 --> return null
- getGuardFromModel(Model $model) :?string
        - return getGuardFromProvider(getProviderFromModel($model))

- when i use the HELPER ??
        - if the input of function and output of function is general.
        - we use it as a helper.



        - make folder in app >> support >> helpers.php and add functions
        - register the helper file in composer.json
            - autoload
                    { "psr4":{},
                        "files":["app/Support/Helpers.php"] 
                    }
            - composer dumpautoload


        - protected function resetUrl($notifiable){
            - $guard = getGuardFromModel($notifiable);
            - make mapping [ web --> users, seller --> sellers, ....] 
                as mapping array in Middleware\EnsureEmailIsVerified.php
                - private array $routeGuardMap = [
                    'web'=>'users.',
                    'seller'=>'sellers.'
                ];
            - put the array in configration of the application --> config\auth.php
            - 'route_guard_map' => [ 'web'=>'users.', 'seller'=>'sellers.', ......]
            - and we can this array in any place 
            - and update the code in middleware and notifications
                - remove array and getter
            - put getRouteGuardMap in helpers : 
                - return config('auth.route_guard_map')[$guard]?? 'users.'

            
            
            - update VerifyUserEmail
                - function verificationUrl($notifiable)
                    - $guard = getGuardFromModel($notifiable);
                    - getRouteGuardMap($guard).'verification.verify',
            
            - update RestUserPassword
                - function resetUrl($notifiable)
                    - $guard = getGuardFromModel($notifiable);
                    - return url(route( getRouteGuardMap($guard) . 'password.reset', [

            - Rename classes to VerifyEmail & RestPassword & in user model
            - put two method in 2 traits:- 
                app\Traits\sendEmailVerificationNotification --> sendEmailVerificationNotification()
                app\Traits\sendPasswordResetNotification     --> sendPasswordResetNotification($token)
                
            - use these traits in your model

------------------------------------------------------------------------------------------------------------
** Seller Auth
-----------------------------------------
    1- routes
    2- Controllers/Seller/Auth
    3- resources  guard, route, url 
    4- model Seller
        class Seller extends Authenticatable implements MustVerifyEmail {
            use HasApiTokens, HasFactory, Notifiable, SendEmailVerificationNotification, SendPasswordResetNotification; 
    5- migration, tables, add shop name, phone in views, method RegisteredUsercontroller.

1- Error resources :-
    - How to make component
        * \app\View\Components\AppLayout.php
            -  return view('user.layouts.app');
        * \app\View\Components\GuestLayout.php
            -  return view('user.layouts.guest');
        * \app\View\Components\AppSellerLayout.php
            -  return view('seller.layouts.app');
        * \app\View\Components\GuestSellerLayout.php
            -  return view('seller.layouts.guest');

<x-app-layout>    --> <x-app-seller-layout>
<x-guest-layout>  --> <x-guest-admin-layout>

- middleware(guest:web)
    لو انا عامل لوجين كيوزر دايما يوديني داشبرود
    لو انا عاوز ادخل السيلر داشبورد وانا مش عامل لوجين هيرميني ع اللوجين

    Difference:- 
        1- auth  عامل login , register   --> ممنوع من login
        2- guest  مش عامل not login      --> ممنوع من dashboard

2- app\Http\Middleware\Authenticate.php

    * condition middleware اي تغير في اسم الجارد هيسمعني هنا
    * علي حسب الجارد علي حسب الميدلوير
    * ميثود الهاندل هي اللي مهمه في الميدل وير
    * عند ابوه الميدل وير
    * عاوز ابعت الجاردز لميثود الريديريكت بدون ما اعمل اوفر لود

    a- first solution 
        - unauthenticated($request, array $guards){
            throw new AuthenticationException(
                'Unauthenticated.',
                $guards,
                $this->redirectTo($request, $guards)
            );

        - redirectTo وهسيبها زي ما هي ببرامتر واحد الريكوست
        - fun_get_args اللي بباصسهم في الفانكشن

    b- حل تاني اعمل ميثود تانيه
        
        - unauthenticated($request, array $guards){
            throw new AuthenticationException(
                'Unauthenticated.',
                $guards,
                $this->redirectToRoute($request, $guards)
            );
    
        - redirectToRoute($request, $guards)
        - redirectTo($request)
                foreach ($guards as $guard) {
                    if ($guard === 'web') {
                        return route('users.login');
                    } elseif ($guard === 'seller') {
                        return route('sellers.login');
                    } elseif ($guard === 'admin') {
                        return route('admins.login');
                    }
                }
3- Problem Notes:- 
    - مشكله انه مش لاقي الجارد فبيعمل ريديركت مهمه
    - 37 مهمه شرح الجارد 
        انا دي الوقتي عامله لوجين كيوزر فجاردي الديفلوبرحبيت ادخل ع داش بورد سيلر
        هيظهر جارد السيللر يحمي الراوت ومن هنا جت اللخبطه

    - solution routes
        Replace Route::middleware('guest') -> Route::middleware('guest:seller')
        Replace Route::middleware('guest') -> Route::middleware('guest:admin')
  
4- app\Http\Middleware\RedirectIfAuthenticated.php


    a- class RedirectIfAuthenticated بيتحكم في الجيست

        - handle(Request $request, Closure $next, ...$guards){
            $guards = empty($guards) ? [null] : $guards;
            foreach ($guards as $guard) {
                if (Auth::guard($guard)->check()) {               // لو الشخص عامل لوجين
                    if ($guard === 'web') {
                        return redirect()->route('users.dashboard');
                    } elseif ($guard === 'seller') {
                        return redirect()->route('sellers.dashboard');
                    } elseif ($guard === 'admin') {
                        return redirect()->route('admin.dashboard');
                    }}}
            return $next($request); }}                            // مش شخص عامل لوجين كمل علي ريكوستك
------------------------------------------------------------------------------------------------------------
** ProfileController Updates in User, Seller **
------------------------------------------------

    - profilecontroller هعمل fire event لو غير الميل  
    - profileControler abstractAuth
        - fire mail event(new Registered($user)) //معدل علي ايميله  يبعتله ميل
        - app\Http\Controllers\AbstractAuth\Auth\ProfileController.php 
            public function update(ProfileUpdateRequest $request): RedirectResponse
                {
                    $request->user($this->getGuard())->fill($request->validated());

                    if ($request->user($this->getGuard())->isDirty('email')) {
                        $request->user($this->getGuard())->email_verified_at = null;
                    } .........}

    - notes: fire verified event(new Verified($user)) 
      // بعد ما دوس علي اللينك ده اللي بيملي الداتابيز بال توكن بعد ما ادوس علي لينك الفيرفايد في الاخر
       
------------------------------------------------------------------------------------------------------------
** Admin Auth
-----------------------------------------

1- Routes Updates
    How to insert admin in database:- 
        - run query static وخلاص عندي
        - صفحه الادمن تشتغل واحد يتسجل وبعدين اقفل
        - Route::middleware(['auth:admin', /*'verified:admin'*/])  // stop this middleware

2- make AdminFactory first
    - php artisan make:factory AdminFactory
    - class AdminFactory extends Factory
        - definition() --> 
            return [
                    'name' => fake()->name(),                                                     // package
                    'email' => fake()->unique()->safeEmail(),
                    'email_verified_at' => now(),
                    'password' => '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', // password
                    'remember_token' => Str::random(10)

        - unverified() --> 
            return $this->state(fn (array $attributes) => [ 'email_verified_at' => null,]

3- database\seeders\DatabaseSeeder.php   الوسيط بين الداتا بيز والفاكتوري

    - admin::factory(10)->create();
        بعد ما اعمل والجدول يكون جاهز migration

    - Admin::factory()->create([
                'name' => 'Admin',
                'email' => 'admin@ecommerce.com',
                'password' => bcrypt('admin')
            ]);

    - الامر ده احطه يعد ما اعمل ميجراشن لجدول الادمن
    - php artisan db:seed
4- copy admin as seller in controllers, views, components
5- controllers without
    - EmailVerificationNotificationController
    - EmailVerificationPromptController
    - RegisteredUserController
    - VerifyEmailController
6- model
    - Admin 
        - extends Authenticatable 
        - doesnot implement MustVerifyEmail
        - use HasApiTokens, HasFactory, Notifiable, SendPasswordResetNotification only
        
7- views without views related deleted controllers
    - Delete \resources\views\seller\profile\partials\delete-user-form.blade.php
    - Delete this section  resources\views\admin\profile\partials\update-profile-information-form.blade.php

        <!-- <form id="send-verification" method="post" action="{{ route('users.verification.send') }}">
        </form> -->
        <!-- @if ($user instanceof \Illuminate\Contracts\Auth\MustVerifyEmail && ! $user->hasVerifiedEmail()) 
        @endif -->

    - profilecontroller هعمل fire event لو غير الميل  مش هعملها مع الادمن

8- components
    x-admin-app, x-admin-guest, .....
- note:- jwt package : guard "api" مبيعتمدش ع السيشن بيعتمد علي دريفر تاني هيوصل الداتا من البروفايدر للجارد
--------------------------------------------------------------------------------------------------
** testing **
-------------

- in the last test the cycle Auth and Seller Profile, Admin Profile, User Profile
    - login problem:- 

    هنخلي ال authenticate function
    تاخد parameter  $guard
    اللي احنا بنجيبه من getGuard
    في كل controller
    وجوا ال LoginRequest
    هتباصي لل guard function ال parameter ده
    - AbstractAuth -->  AuthenticatedSessionController

        public function store(LoginRequest $request): RedirectResponse
        {
            $request->authenticate($this->getGuard());      // This is the line 

            $request->session()->regenerate();

            return redirect()->route($this->getRouteNamePrefix() . 'dashboard');
        }

    - LoginRequset Class
    
        public function authenticate($guard)               // Add parameter to this method 
        {
            $this->ensureIsNotRateLimited();

            if (! Auth::guard($guard)->attempt($this->only('email', 'password'), $this->boolean('remember'))) {
                RateLimiter::hit($this->throttleKey());

                throw ValidationException::withMessages([
                    'email' => trans('auth.failed'),
                ]);
            }

            RateLimiter::clear($this->throttleKey());
        }
------------------------------------------------------------------------------------------------------
// ********* Front-End ********* //
------------------------------------------------------------------------------------------------------


اول ما ندخل تبقي صفحه الاندكس

    1- css, js , fonts, packages, front
    2- التقسيمه
    3- وال invokable controller
        مهمه واحده 
    4- يفتح صفخه الاندكس
    5- مبحددش الميثود وانا بعمل الراوت

1:42
    frontend- where? 
    1- assets public
    2- or resources server render preformance high
    3- donot depend on cdn


routes
frontend.php
require it in web.php


2/10

AdminCycle
ProfileRequest
PasswordController


------------------------------------------------------------------------------------------------------














- public/front-end-assets (user هيدخل عليه ال()
    copy images, packages, css, js and fonts folders from frontend folder.
- Public/dashboard-assets (admin, seller هيدخل عليه ال()
    copy plugins, dist from admin-assets folder.
- resources/views/user/html
    copy html pages.

notes:-
- هنخلي الصفحه اول ما تفتح تبقي صفحه الويب سايت
- واليوزر يعمل لوجين ويروح برضه لصفحه الاندكس

- خاصه باليوزر فندخلها جوه

    Route::get('/', function () {
        return view('user.welcome');
    })->name('welcome');

- وندخل الصفحهwelcome دي جوه فولدر اليوزر في الريسورس
rename and move welcome.blade.php --> resources\views\user\index.blade.php


-\routes\frontend.php
    - فيه كل الراوتس الحاصه بالفرونت وانكلودها في الويب
Route::get('/', IndexController::class)->name('users.dashboard');
    - php artisan make:controller User/IndexController --invokable
    - هيتنده عليه لوحده وليه مهمه واحده وميثود واحده ومبذكرهاش وانا بعمل الراوت 
    - public function __invoke()
        {
        return view('user.dashboard');
        }
- اي حاجه بتودي ع الداش بورد خليه يودي ع ال index 
بس هيكتر عليه في التغيرانت فهاسمي الصفحه داش بورد ولكن محتواها صفحه الاندكس بالنسبه لفيو اليوزر

-وقف الراوتس ده في \routes\users.auth.php
    // Route::get('/dashboard', function () {
        //     return view('user.dashboard');
        // })->name('dashboard');
        

--------------------------------------------------------
Templates Inheritance
---------------------

- Header, Footer, back to top ثابتين في الاب
- copy (\resources\views\user\html\index.html) content in userIndex (\resources\views\user\dashboard.blade.php)
- all css, js, images, .... href or src = from domain 
- (http://127.0.0.1:8000/frontend-assets/css/main.css) == asset('/frontend-assets/css/main.css')
  (currentDomain/frontend-assets/css/main.css)


- create resources\views\user\layouts\parent.blade.php
  include all static dashboard user content 
	- <title>@yield('title')</title>
    - @stack('links')</head>  لو حبيت ازود لينكات في الفحات الجايه جافا و css
	- @yield('content')
    - @stack('scripts')
    - delete from parent
        <!-- Slider -->
        <!-- Banner -->
        <!-- Product -->
        
    - divide the static content to component in resources\views\user\layouts\partials
        <!-- Footer --> resources\views\user\layouts\partials\footer.blade.php
        <!-- Header --> resources\views\user\layouts\partials\header.blade.php
        <!-- cart -->   resources\views\user\layouts\partials\cart.blade.php
        
    1- in parent
        @section('footer') 
        سكشن متغير
        سكشن وفي نفس الوقت yield
        وبراحتك تقدر تعمله انكلود عادي هناك في ال child
        @show

    2- in child
        @extends('user.layouts.parent')
        @section('title','Home')

        @section('content')
            المحتوي
            <!-- Slider -->
            <!-- Banner -->
            <!-- Product -->
        @endsection

        @section('footer') 
        @parent
        ................ // append doesnot override
        @endsection

    3- condition in header.php
        @auth('web') 
            <a href="#" class="flex-c-m trans-04 p-lr-25">
                My Account
            </a>
        @endauth  

        or
        
        @if(Auth::guard('web')->check())

        @endif

        <ul class="main-menu" > 
                        <li class="active-menu">
                            <a href="#" class="dis-block icon-header-item cl2 hov-cl1 trans-04 p-l-22 p-r-11">
                                <i class="zmdi zmdi-account"></i>
                            </a>
                            <ul class="sub-menu">
                                @auth('web')
                                    <li><a href="index.html">Profile</a></li>
                                    <li><a href="home-02.html">Logout</a></li>
                                @else
                                    <li><a href="index.html">Login</a></li>
                                    <li><a href="home-02.html">Register</a></li>
                                @endauth
                            </ul>
                        </li>
                    </ul>
---------------------------------------------------------------------------------
Study:-
    - how to send mail, notification ???? ' طريقتين يبعتوا ميل
    - middleware parameters ???
    - fake() package
    - gitflow
    - tamplates inheritance 
    - enums https://www.php.net/manual/en/language.enumerations.backed.php
    - method check() Auth::guard('seller')->check() || Auth::guard('admin')->check();
    - 
    - html
    - نذاكر كويس الايفنتس
    - خلصنا التيست 

---------------------------------------------------------------------------------
MyProblems:- 
    - test users\dashboard when login as sellers
    - return route('users.login'); ??? من الاول خالص وانا عندي مشكله
        - route seller register  --> validation
        - profile --> Target class معملتش use in routes
        - forget password --> name of class error
        - النيم سبيس ال profilecontroller
        - login seller, admin
        - request handel ???

    - user cycle ok.
    - seller cycle ok
---------------------------------------------------------------------------------
** github **
-------------------
** pullrequet **
طلب للتعديل بتاعي عند الادمن

    0- master branch 
    1- git clone https://github.com/galal-husseny/ecommerce-b2    // git clone in your laptop
    2-  git checkout -b mai                                       // make branch جديد  
        composer install
        .env
        php artisan key:generate
        npm install
        npm run dev
        
    3- edit the line code 
    4- galal المتحكم 
    5- in my branch
        git add .
        git commit 
        git push this is not right
        
    6- ui, migration
---------------------------------------------------------------------------------
.git.ignore
public/frontend-assets
public/dashboard-assets
package-lock.json
composer.lock
لازم 
composer, package.json يكونو موجودين
--------------------------------------------------------------------
git flow
git rm --cashed -r composer.lock

@stack('scripts')

git history 
git length

--------------------------------------------------------------------------------------------------------
problem validation:- 
--------------------------
1- ProfileController:-
    public function update(Request $request): RedirectResponse
        {
            // request جايلي لارفل متقدرش تحدد انا في انهي جارد 
            $rule = [
                'name' => ['string', 'max:255'],
                // 'email' => ['email', 'max:255', Rule::unique(User::class)->ignore($this->user()->id)],
                // 'email' => ['email', 'max:255', 'unique: table-name, column-name, without id= id userlogin],
                'email' => ['email', 'max:255', 'unique:'.$request->user($this->getGuard()).',email,'. $request->user($this->getGuard())->id],
            ];
        


2- PasswordController
    app\Http\Controllers\AbstractAuth\Auth\PasswordController.php
    update this line:-
        - 'current_password' => ['required', 'current_password']
        - 'current_password' => ['required', 'current_password:'.$this->guard]


--------------------------------------------------------------------------------------------------------
we will add:-
--------------------------
    1- facebook login 
    2- caption robot

------------------------------------------

add in .gitignore 
    /public/frontend-assets
    /public/dashboard-assets
    composer.lock
    package-lock.json
-----------------------------------------------------------------------------------------------------------------
translation:
- edit all pages in two lang 
    - two folders in lang (en, ar)
    - validation , messages files with the same keys and different content (download from internet)
        - call it in blade by
        -   @if ($errors->get('phone'))
                <ul class='text-sm text-red-600 dark:text-red-400 space-y-1 mt-2'>
                    @foreach ($errors->get('phone') as $message)
                        <p class="text-danger">{{ $message }}</p>
                    @endforeach
                </ul>
            @endif
    - i should be known that the content of pages are divides to 3 types 
        1- didnot translate 
        2- db translation
        3- can be translate 
- after translate all pages, we install mcamara package  ( https://github.com/mcamara/laravel-localization )
- in the parent page:-
    @if (App::currentLocale() == 'en')
        <html lang="en" dir="ltr">
    @else
        <html lang="ar" dir="rtl">
    @endif

- in the header page:-
     @foreach (LaravelLocalization::getSupportedLocales() as $lang => $value)
        @if ($lang == App::currentLocale())
            @continue
        @endif
        <a rel="alternate" hreflang="{{ $lang }}" href="{{ LaravelLocalization::getLocalizedURL($lang, null, [], true) }}"class="flex-c-m trans-04 p-lr-25">
            {{ Str::upper($lang) }}
        </a>
    @endforeach
------------------------------------------------------------------------------------------

1- insert in db category, product, seller

2- IndexController
    - $products = Product::select('id', 'name', 'sale_price')->limit(16)->get();
    - return view('user.dashboard', compact('products'));

3- dashboard view
    - forloop $product depond on App::currentLocale().
    - https://github.com/spatie/laravel-translatable.
    - handel it with package in model, setup, dashboard view.
-----------------------------------------------------------------------------------------------------
الفرق بين حساب البائع وحساب البائع الخاص بك 

    - انا يوزر فعاوز اعمل اكونت سيلر وهيطلب منك حاجات زياده 
    - new table ( sellers and in the same acount )/ فيه المعلومات الزياده اللي محتاجها هدخل فيه بيانات / بيورث من اليوزر ملوش شخصيه& user_id 
    - وساعتها لازم تكون يوزر عشان تبقي سيلر 
    - وكمان الجارد هيكون user 
    - جارد جديد يعني سيشن جديد وجدول جديد بمعلومات جديده فانا هنا هحتاج بس يوزر وادمن
-----------------------------------------------------------------------------------------------------
crud product in seller:- 
------------------------------------------------------
    1- php artisan make:controller ProductsController --resource
    2- Route::prefix('sellers')->name('sellers.')->middleware(['auth:seller', 'verified:seller'])->group(function() { Route::resource('products', ProductsController::class);});
    3- In ProuctsController 
        - index()
            $products = Product::where('seller_id', Auth::guard('seller')->id())->get()
            return view('seller.products.index', compact('products'))
    4- view /seller /products 
        - index داتا تابل
        - create folder Enums/CategoryEnum.php
            enum CategoryEnum :int { case ACTIVE = 1;  case NOT_ACTIVE = 0; }
            https://www.php.net/manual/en/language.enumerations.backed.php
    5- In ProuctsController 
        - create()
            $categories = Category::where('status', CategoryEnum::ACTIVE->value)->get();
            return view('seller.products.create', compact('categories'));

        - store()
            - create validation request in this path  ----> app\Http\Requests\Product\StoreProductRequest.php
            - StoreProductRequest extends FormRequest
                    - authorize() { return Auth::guard('seller')->check() || Auth::guard('admin')->check(); }
                        - request can be sharables between many controllers //
                        - check() method return (yes or no).

                    - rules() --> return [
                                "name"   => ['required', 'array:ar,en'],
                                'name.*' => ['required', 'min:2', 'max:128'],

                                "description" => ['required', 'array:ar,en'],
                                'description.*' => ['nullable', 'min:2', 'max:1000000'],

                                "purchase_price" => ['required', 'numeric', 'min:1', 'max:99999999.99'],
                                "sale_price"     => ['required', 'numeric', 'min:1', 'max:99999999.99'],
                                وخلي سعر البيع يكون اعلي من الشراء

                                "quantity" => ['required', 'integer', 'min:1', 'max:999'],
                                "status"  => ['required', 'in:0,1'],
                                "image"   => ['required', 'mimes:png', 'max:1024'],

                                "category_id" => ['required', 'integer', 'exists:categories,id']]
            - تظبيط الفيو 
            - ازاي اجيب الحاجات المترجمه
                @if ($errors->any())
                    <div class="alert alert-danger">
                        <ul>
                            @foreach ($errors->all() as $error)
                                <li>{{ $error }}</li>
                            @endforeach
                        </ul>
                    </div>
                @endif
                
                <form method="post" action="{{ route('sellers.products.store') }}" enctype="multipart/form-data">
                    @csrf
                    
                    <input type="text" name="name[en]" class="form-control" id="name_en">

                    <input type="text" name="name[ar]" class="form-control" id="name_ar">
                    @if ($errors->get('name.ar'))
                        <ul class='text-danger  space-y-1 mt-20'>
                            @foreach ($errors->get('name.ar') as $message)
                                <p class="text-danger">{{ $message }}</p>
                            @endforeach
                        </ul>
                    @endif
                    
                    <input type="number" name="purchase_price" class="form-control" id="purchase_price">             
                    <input type="number" name="sale_price" class="form-control"  id="sale_price">
                    <input type="number" name="quantity" class="form-control" id="quantity">
                   
                    @if ($errors->get('quantity'))
                        <ul class='text-danger  space-y-1 mt-20'>
                            @foreach ($errors->get('quantity') as $message)
                                <p class="text-danger">{{ $message }}</p>
                            @endforeach
                        </ul>
                    @endif

                    <select name="status" class="form-control" id="status">
                        <option value="" disabled selected></option>
                        <option value="1">{{__('seller.add_product.active')}}</option>
                        <option value="0">{{__('seller.add_product.not_active')}}</option>
                    </select>
                    
                    <select name="category_id" class="form-control" id="category_id">
                        @foreach ($categories as $category)
                            <option value="" disabled selected></option>
                            <option value="{{$category->id}}">{{$category->name}}</option>
                        @endforeach
                    </select>
                                        
                    <textarea class="form-control" name="description[en]" placeholder="{{__('seller.add_product.description_en')}}"></textarea>
                    <textarea class="form-control" name="description[ar]" placeholder="{{__('seller.add_product.description_ar')}}"></textarea>

                    <input type="file" class="d-none" name="image" id="file" onchange="loadFile(event)">
                    <label for="file">
                        <img src="{{asset('custom-images/default.png')}}" alt="default" class="w-100 " id="image" style="cursor: pointer">
                    </label>

                    <button type="submit" class="button-general w-50"> {{__('seller.add_product.submit')}} </button>               
                </form>
            
                @push('scripts')
                    <script>
                        var loadFile = function(event) {
                            var output = document.getElementById('image');
                            output.src = URL.createObjectURL(event.target.files[0]);
                            output.onload = function() {
                            URL.revokeObjectURL(output.src) // free memory
                            }
                        };
                    </script>
                @endpush

----------------------------------------------------------------------------------------------------
how to remove tailwind from the all project
----------------------------------------------------------------------------------------------------
    
    - store()
        - validation (form request)       
            - C:\xampp\htdocs\studing\ecommerce-b2\app\Http\Requests\Product\StoreProductRequest.php
            - difference between ($request->all, validated(), only(), expect())
            - validated(), only() اللي بنعتمد عليهم

        - developer generate code for seller in trait
            - unique identifier for التعامل اللي مش مباشر in stock.
            - unique identifier for التعامل المباشر )(التليفون والميل ) تعامل مع الداتا بيز in db
            - add specs (الرامات البطاريه ......).

        - image uploaded by two methods:-
                - laravel (المنحه)
                - package images (polymorphic relationship)
                    - بيكون فيه جدول للميديا وببقي محتاج اسم الجدول صاحب الصوره وكمان ال id(modal_type, modal_id)
                    - images table id, name, type (تبع مين user, seller) , type-id (user-id)
                            - Disks meaning :-
                                --> disk الوندز متقسم عشان التنظيم والداتا متروحش لو عملت ويندز جديد
                                --> C:\xampp\htdocs\studing\ecommerce-b2\config\filesystems.php
                                
                                    - local  ---> not (accessable اقدر اوصلها باليووارال)(ملف جيسون و عقد و.....)     laravel store in it (by default)
                                    - public ---> accessable by url (اي حد يقدر يعملها اكسس)     package store in it (by default)
                                    - s3 (زي الجوجل درايف محفوظه وبالفلوس من امازون) هشتري ارقام اللي في الاراي وكمان اعرف اللارفل ازاي بترفعه 
                                        زي جوجل درايف اي نوع من انواع الفيلات cloud storage to aws(amazon web service paid)

                   - laravel media library  https://spatie.be/docs/laravel-medialibrary
                        - خدبالك انها تكون اخر version
                        - composer require "spatie/laravel-medialibrary:^10.2"
                        - php artisan vendor:publish --provider="Spatie\MediaLibrary\MediaLibraryServiceProvider" --tag="migrations"
                        - php artisan migrate
                        - php artisan vendor:publish --provider="Spatie\MediaLibrary\MediaLibraryServiceProvider" --tag="config"
                    - Automatic will appear this file
                        - C:\xampp\htdocs\studing\ecommerce-b2\config\media-library.php
                    - Prepearing modal
                        - implements HasMedia interface
                        - use InteractsWithMedia trait
                        - use function registerMediaConversions() method to crop image

                    - Associate media
                        - ProductController
                        - $request->validated() --> هيرجعلي اللي موجود في الfillable
                                                    حتي لو انا مدخل الصوره في الفيو والا كاني شايفها

                    - store(StoreProductRequest $request)
                        1- generate code
                            $code = genProductCode();
                        2- validation  هيرجعلي اللي موجود في الfillable حتي لو انا مدخل الصوره في الفيو والا كاني شايفها
                        3- $product = Product::create(array_merge($request->validated(), 
                            ['code' => $code,
                            'seller_id' => Auth::guard('seller')->id() //محتاجها وانا بعمل login]));
                            $product->addMediaFromRequest('image')->toMediaCollection('products'); //image = name of key  //CollectionColumn products
                            return redirect()->route('seller.products.index');}


- How to make success alart ?
    - sweet alert script handel https://sweetalert2.github.io/#usage         
        1- In parent view 
            <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
        2- In index view --> check the session
                @if(session()->has('success')) 
                    <script>
                        Swal.fire(
                            'Good job!',
                            '{{session()->get("success")}}',
                            'success'
                        )
                    </script>
                @endif
                @if(session()->has('error'))
                    <script>
                        Swal.fire(
                            'Something went wrong!',
                            '{{session()->get("error")}}',
                            'error'
                        )
                    </script>
                @endif

        3- create file lang\ar\general.php & lang\en\general.php
            <? php
                return [
                    'messages'=> [
                        'success' => 'تمت العمليه بنجاح ',
                        'updated' => 'تم التعديل بنجاج',
                        'created' => 'تمت الاضافه بنجاح',
                        'deleted' => 'تم الحذف بنجاح',
                        'error' => 'فشلت العمليه',
                    ]
                ]; 

        4- In controller
            return redirect()->back()->with('success', __('general.messages.deleted'))
    
--------------------------------------------------------------------------------------------------------
- The errors of media-laravel package 
    - version package
    - gb library extension 
        https://stackoverflow.com/questions/39990516/laravel-intervention-image-gd-library-extension
--------------------------------------------------------------------------------------------------------
- index.php
    - <a> </a>    --> by default get request
    - get         --> sellers.products.show       --> sellers/products/{product}
    - put patch   --> sellers.products.update     --> sellers/products/{product}
    - delete      --> sellers.products.destroy    --> sellers/products/{product}

    - <a href="{{route('sellers.products.show', $product->id)}}" class="btn btn-sm btn-success my-2 rounded-pill d-inline"> {{__('seller.all_products.show')}} </a>
    - <a href="{{route('sellers.products.edit', $product->id)}}" class="btn btn-sm btn-primary my-2  rounded-pill d-inline"> {{__('seller.all_products.edit')}} </a>
    - <form class="" action="{{route('sellers.products.destroy', $product->id)}}" method="post" class="d-inline">
            @csrf
            @method('DELETE')
            <button class="btn btn-sm btn-danger  my-2 rounded-pill x" type="submit">
                {{__('seller.all_products.delete')}}
            </button>
       </form>
-------------------------------------------------------------------------------------------------
RoutePrameter:-
    - كل ما يبعت id هتروح تجيبه وتعمله find, fail
    - or send it as route parameter
    - destroy(Product $product) دي معناها id من جدول المنتج
    
-------------------------------------------------------------------------------------------------
    - destroy($id)
        - Product::whereId($id)->delete();
        - Product::whereSalePrice(11)->delete();
        - Product::where("id", = ,$id)->delete();
        الثلاث سطور اللي فوق نفس المعني هوه هنا بيقول روح دور في الجدول بالقيمه دي طريقه مختصره
        
        علشان يمسح صورته هات المنتج الاول وبعدين اعمل مسح ليه ع خطوتين 
        $product = Product::findOrFail($id)
        $product->delete();
        return redirect()->back()->with('success', __('general.messages.deleted'))
-------------------------------------------------------------------------------------------------
- How to custom the Media folder according to name of model 
    - edit the path generator in ( config > media-library.php > 'path_generator')
        from  => Spatie\MediaLibrary\Support\PathGenerator\DefaultPathGenerator::class,
        to    => App\MediaLibrary\CustomPathGenerator::class,
    
    - create new folder app/MediaLibrary/CustomPathGenerator.php 
        use App\Models\Product;
        use Spatie\MediaLibrary\MediaCollections\Models\Media;
        use Spatie\MediaLibrary\Support\PathGenerator\PathGenerator;

        class CustomPathGenerator implements PathGenerator
        {
            public function getPath(Media $media) : string
            {
                $path = explode('\\', $media->model_type); //return product
                return end($path) . '/' . $media->id . '/';//return product/1/
            }

            public function getPathForConversions(Media $media) : string
            {
                return $this->getPath($media) . 'conversions/';
            }

            public function getPathForResponsiveImages(Media $media): string
            {
                return $this->getPath($media) . 'responsive/';
            }
        }
----------------------------------------------------------------------------------------------
- edit()
    - repeated code can we write it in parent |OR| resources\views\seller\layouts\partials\errors.blade.php and include it
        @if ($errors->any())
            <div class="alert alert-danger"><ul>
                @foreach ($errors->all() as $error)<li>{{ $error }}</li>@endforeach 
            </ul></div>
        @endif
    - <form method="post" action="{{ route('sellers.products.update', $product->id) }}" enctype="multipart/form-data">
    - <img src="{{$product->getFirstMediaUrl()}}" alt="default"
    
---------------------------------------------------------------------------------------------- 
- How to handel data form ?
    - In createView.php

        - (Array) <input name= "name_en" value = " {{old('name.en')}} "> 
        - (text)  <input name= "email"   value = " {{old('email')}} ">

        - (selectBox) check value of option (static)
            - <option {{ old('status') === '1' ? 'selected' : ""}} value="">
            - <option {{ old('status') === '0' ? 'selected' : ""}} value="">
            OR
            - <option @selected(old('status') === '1' ) value="">
            - <option @selected(old('status') === '0' ) value="">

        - (selectBox) check value of option (DB)
            - <option @selected(old('category_id')==$category->id) value="{{$category->id}}">{{$category->name}}</option>

        - (Text Area)
            - <textarea> {{old('description.en')}} </textarea>

    - In updateView.php ??
        في حاله فتح الصفحه لاول مره هات من الداتا بيز كتبت انا احتف بقي باللي كتبته
        - {{old('quantity',$product->quantity)}}
------------------------------------------------------------------------------------------
- Create model for verify email to user in home page
    @auth('web')
    @if ($user instanceof \Illuminate\Contracts\Auth\MustVerifyEmail && !$user->hasVerifiedEmail())
??????

--------------------------------------------------------------------------------------------------------------------------
17/3/2023
---------------
1- How to preview image:-

الصور جوه فولدر البابلك و اي فولدر تاني انا معرفش اعمله اكسس في اليورل
php artisan storage:link ( مره واحده فقط symbolic link ) uptodate  and not dublicate storage size
هنا هيعمل short cut( public folder in storage folder) to ( public folder)

    - generate link by current domain 
    - edit this line in congig/filesystem/ public
            'url' => env('APP_URL').'/storage'  --> '/storage',

        - first solution asset(.....)in view
        - another solution override function geturl() in CustomUrlGenerator
        
        - in edit blade, show blade :-
            <img src="{{ $product->getFirstMediaUrl('product') }}" alt="default" class="w-100 " id="image" style="cursor: pointer">
            <img src="{{ $product->getFirstMediaUrl('product') }}" class="img-fluid rounded-start" alt="...">
        - in create blade :-
            <img src="{{asset('custom-images/default.png')}}" alt="default" class="w-100 " id="image" style="cursor: pointer">

2- slug :-
    صفحه التعديل عاوزه تعرف اي منتج يتعرض انا ببعت الid في ال url
    لازم يكون في الurl علشان اقدر افتح الصفحه و دي مش حاجه سكيور  و 
    الحل نعبر عن المنتج بحاجه تانيه غير الid  بحاجه اسمها slug

    - Advantages:-
        - more user friendly ---> SEO  مهم في ال
        - hide id from url to more secure
        - نفس اسم المنتج بدون مسافات new-labtop 
        - ولازم تكون unique
        - for 2 seller with the same slugProduct 
            - الويب سايت يعترض او
            - يا هتزود ارقام في الاخر
    - how to create slug:-
        - by php str_replace(" ","-","hello mai") ---->hello-mai واتاكد انه مش متكرر طول الوقت
        - by laravel (::slug ) in documentation
        - by package (laravel-sluggable-spatie) https://github.com/spatie/laravel-sluggable
    - when i can repeate the slug?
        ممكن السلج تتكرر انا وحد غيري محتاج نفس الحاجه في نفس الصفحه ولكن السيرش مختلف
        بتفرج ع ماتش الاهلي مع غانا  والزمالك مع بعض في نفس الصفحه نفس ال destenation
    - steps:-
        - install package.
        - integrated with translatable laravel.
        - edit the product model
            use HasTranslatableSlug
            public $translatable = ['name', 'description', 'slug'];
            getSlugOptions(): SlugOptions{ return SlugOptions::create()
                                            ->generateSlugsFrom('name')
                                            ->saveSlugsTo('slug')
                                            ->usingLanguage(false);}


        - edit migration table product by column slug --> json('slug')
        
            php artisan make:migration add_slug_to_products --table="products"
                up()   -->  Schema::table -->  $table->json('slug');
                down() -->  Schema::table -->  $table->drop('slug');
            php artisan migrate
        
        - مينفعش اعمل تعديل ع منتج معندوش اسلج

    - problem بيرجع فرانكو :-
        - حلها في ال product model 
            - language(false)
            - trait  --> use EscapeUnicodeJson
 
    - The difference between:-
        {product:slug} modelBinding  معناها شوف السلاج انه برايمري كي في المودل بيندينج | معتمد  علي السلاج في الداتابيز لازم يتبعت 
        {product} modelBinding معتمد علي الايدي في الداتابيز لازم يتبعت
        {id} راوت برامتر عادي

    - The steps can be:- (modal , db, route) slug Constant
        1- depend on slug (primary key) in all url crud routes and views && send id as parameter 
            - by package (in modalFile) (طول ما انا شغال ع جدول المنتج البريمري كي هو السلاج)
                1- In sellers.php   
                        Route::get('test/{slug}/{id}, function($slug, $id){
                            $product = Product::findOrFail($id);
                            echo $product->name;
                        });
                2- and in Model > Product.php  
                        public function getRouteKeyName(){
                            return 'slug';
                        } 
                        الحل ده هوه الافضل لان قصه اللاهىيهىل لل مودل وليس في الراوت 

            - or by laravel in route file
                {product:slug}/{id} modelBinding  معناها شوف السلاج انه برايمري كي في المودل بيندينج | معتمد  علي السلاج في الداتابيز لازم يتبعت 

            - note:-
                - وانا بعدل علي المنتج هعمل ايه في السلاج
                - depend on slug as primary key
                    1- slug هثبته
                    2- slug هغيره
                        - مينفعش return redirect()->back();
                        - expired url when sherable link with friends

        2- by route file هكتب بس ( ببعت السلاج كبرامتر لكن مازال الاساسي عندي ال id) 
                - Nested route in same resource controller, route عاديه فك الريسورسز
                - We write it in routes instead of --> Route::resource('products', ProductsController::class);
                    Route::prefix('products')->name('products.')->controller(ProductsController::class)->group(function()
                        Route::get('/', 'index')->name('index');
                        Route::post('/', 'store')->name('store');
                        Route::get('/create', 'create')->name('create');
                        Route::prefix('{product}')->group(function() {
                            Route::put('/', 'update')->name('update');
                            Route::delete('/', 'destroy')->name('destroy');
                            Route::get('show/{slug?}', 'show')->name('show');
                            Route::get('edit/{slug?}', 'edit')->name('edit');
                - Note:-
                    - الفرق بين ال route parameter, model binding by id, slug another column
                    - خلي ال nullable في الاخر 
                    - {slug?} optional هنخليه في الاخر في الفانكشن وكمان في الاخر في الراوت 

                - The methods:-
                    - show(Product $product, string $slug = null) --> return view('seller.products.show', compact(['product']))
                    - edit(Product $product, string $slug = null) --> return view('seller.products.edit', compact('product', 'categories'));
                        انا محتاج السلاج في اللينكات اللي هشوفها
                        الترتيب اللي هبعته كبرامتر هنا في الميثود مهم يكون مطابق للراوتس
                
                - The View:-
                    - <a href="{{route('sellers.products.show', ['slug' =>$product->slug, 'product' => $product->id])}}" class="btn btn-sm btn-success my-2 rounded-pill d-inline"> {{__('seller.all_products.show')}} </a>
                    - <a href="{{route('sellers.products.edit', ['slug' =>$product->slug, 'product' => $product->id])}}" class="btn btn-sm btn-primary my-2  rounded-pill d-inline"> {{__('seller.all_products.edit')}} </a>
                    - <form class="" action="{{route('sellers.products.destroy', $product->id)}}" method="post" class="d-inline">
                                            
                - show(Product $product, string $slug = null )
                    return view('seller.products.show', compact('product') );

                - edit(Product $product, string $slug = null)
                    $categories = Category::select(['id', 'name'])->where('status', CategoryEnum::ACTIVE->value)->get();
                    return view('seller.products.edit', compact($product, $categories));

                - Product/UpdateProductRequest:-
                    - authorize() -->  return Auth::guard('seller')->check() || Auth::guard('admin')->check();
                    - rules() --> { return [
                            "name" => ['required', 'array:ar,en'],
                            'name.*' => ['required', 'min:2', 'max:128'],
                            "purchase_price" => ['required', 'numeric', 'min:1', 'max:99999999.99'],
                            "sale_price" => ['required', 'numeric', 'min:1', 'max:99999999.99'],
                            "quantity" => ['required', 'integer', 'min:1', 'max:999'],
                            "status" => ['required', 'in:0,1'],
                            "category_id" => ['required', 'integer', 'exists:categories,id'],
                            "description" => ['required', 'array:ar,en'],
                            'description.*' => ['nullable', 'min:2', 'max:1000000'],
                            "image" => ['nullable', 'mimes:png', 'max:1024'],];}}
                
                
        3- or depend on id hash && slug Constant
            - هتنفع return redirect()->back();
            - وساعتها مهما غيرت في السلج لما يعمل باك هيبقي بناء ع ال id
            - ساعتها هلغي الميثود اللي في المودل وتعديلي يكون في ال web.php
                هبعت البرامتر هناك في الراوتس (slug, id)
                ولما اروح اجيب المنتج اجيبه عن طريق ال id
            - named parameter
            - $id with encryption:-
                1- hash       (لكن هنا بشفر مبعرفش ارجعها) (انا بس اللي عارف)
                2- encryption اشفر الرساله محدش فاهم غير انا واللي عاوزه يفهم)(الاتصالات)) هقدر ارجعه
            
            - Steps how to make encryption and decreption:-
                1- manual
                    - view responsible for encrypting id 
                        (crypt::encryptString($product->id))
                        (use name space before name of class )
                        
                        <a href="{{route('sellers.products.show', ['slug' =>$product->slug, 'product' => \Illuminate\Support\Facades\Crypt::encryptString($product->id)])}}" class="btn btn-sm btn-success my-2 rounded-pill d-inline"> {{__('seller.all_products.show')}} </a>
                        <a href="{{route('sellers.products.edit', ['slug' =>$product->slug, 'product' => \Illuminate\Support\Facades\Crypt::encryptString($product->id)])}}" class="btn btn-sm btn-primary my-2  rounded-pill d-inline"> {{__('seller.all_products.edit')}} </a>
                        <form class="" action="{{route('sellers.products.destroy', \Illuminate\Support\Facades\Crypt::encryptString($product->id))}}" method="post" class="d-inline">

                    - Controller responsible for decrypting id   
                        method in modal 
                        Crypt::decryptString($request->token)


                2- another method
                    a- UUID universal unique alph numeric identifiers
                        - 36 length unique string in db
                        - بدل ما يكون اعتمادي علي id هيكون معتمد علي uuid
                        - عيبه انه اسم مش رقم فالدنيا هتكون بطيئه ووقت في الداتابيز
                        - performance low in frontend
                    steps:-
                        - in model protected $appends=['UUID'];
                        - in db add column in product table.
                        - protected function uuid(): Attribute {
                                return Attribute::make(
                                    set: fnnction (string $value) { 
                                        return 'ok';
                                    }
                                );}    
                        - add it in fillable array
                    b- ULID
                        - 26 length unique string in db
                
                Note:- 
                    - حوار الانكريبت والدكريبت بدون جدول فب الداتابيز مخالف للمودل بايندنج
                        1- هنعمل middleware في النص middleware وفشل
                                - php artisan make:middleware x
                                - add it in kernal
                                - ->name('show')->midelware('x')
                            - سبب الفشل -> by default (route --> RouteModelBinding --> middleware --> controller)
                       
                        2- create two UUID, Id columns in db
                            Id  هبحث بيه ال modelBinding
                            هيغير الداتاتايب للاي دي هيبقي استرينج ومش برايمري كي
                            UUID هعمل بيه التشفير

                3- make helper function manual ( php native )  

                4- customize the resolution route
                https://stackoverflow.com/questions/71168670/how-to-pass-encrypted-id-as-route-parameter-in-laravel-route-model-binding
                
                    - Add in routeService provider to control model binding
                        method boot()
                        Route::bind('user', function ($encryptedId) {
                            return User::where('id', Crypt::decryptString ($encryptedId))->firstOrFail();
                        });
                        بس مش انسب حل مع كل مودل هيستخدم الانكربت هضطر اكرر السطرين دول لكل مودل جديد
                                    
                
                    - Create HasEncryptedIds and Use this trait in model
                        resolveRouteBinding($encryptedId, $field = null) --> 
                            return $this->where('id', Crypt::decryptString($encryptedId))->firstOrFail();
                            لو انت هتبعت ال url متشفر استخدم التريت ده
                            
------------------------------------------------------------------------------------------------------------------
24/3/2023
----------------------
form repeater specs
scopping (to do not repeate filteration)()
- global scope https://laravel.com/docs/10.x/eloquent#global-scopes
    - by default مطبق معاك
    - not readability
    - folder Scopes جمب المودل
        ActiveScope class implements Scope
        function Apply 
        $builder->where('status',1)
    - category modal
        function هنده فيها 
        documentation????????????????
        protected static function booted(): void
        {
            static::addGlobalScope(new ActiveScope);
        }

    - category::withoutGlopalScope(ActiveScope::class)->get();
    - category::all();
- local scope
    - by default لازم تنده عشان تطبقه
    - model cataegory 
        public function scopeActive(Builder $query): void{
            $query->where('status',......);
        }
    - controller
        ->active()->get();
        ->active()->toSql(); //to print query
        or laravel-depugbar package (طول ما انا شغال ديفلوبر بس واول ما يدخل برودكشن هيقف )
        2 queries 
            1- select * from 'sellers' where 'id' =1 limit=1  ----> middelware auth 
            2- select 'id','name' from 'category' where status=1 ---> scope
        
        to control debug bar:-
        .env APP_DEBUG=true
             APP_DEBUG=false

        1- readable table products
            - status value
                App\Enums\CategoryEnum::tryFrom(1)?->name
                ? لو اللي جاي null متكلمش ال name
            
                $product->status ? 'active':'not active';

                or helper
                    function printEnum($enum, mixed $value){

                        ucfirst(strtolower(str_replace("_", " ", $enum::tryFrom($value)?->name)));

                        // ucfirst(strtolower(str_replace("_", " ", App\Enums\CategoryEnum::tryFrom($product->status)?->name)));
                    }
                in view
                {{__("translate.".printEnum(App\Enums\CategoryEnum, $product->status))}}

                ------------------------------------------------------------------------
                - color status
                    class="{{$product->status? 'text-green':'text-danger'}}"
                    or
                    @class([
                        'font-bold',              //متحقق دايما
                        'text-success'=> $product->status, //مش هيتجحقق
                        'text-danger'=> !$product->status,     //هيتحقق
                    ])
--------------------------------------------------------------------------
    seller name ملوش لازمه
    category name 
        category_id
        category relation 

by sql (query builder):-
    - select, join 
    - high preformance. (1000 query -> 1 query) without mapping

by laravel (eloquent):-
    - $product->category->name
        - عدد الكويلاري زادت جدا بعد ما جبت اسم الكاتوجري والبريفورمنس هيقل
        - lazy loading low preformance (n+1 problem) (1000 query -> 1001 query)
        - solution (with method in controller --> eager loading) (1000 query -> 2 query)
    
    - $product= product::with('category')->where('seller_id', Auth::guard('seller')->id())->get();
        eloquent model mapping data كل كاتيجوري نيم بصاحبها

--------------------------------------------------------------------------
show blade
$product[0]-> remove zero

show Method() in controller
    $product->load('category') بدل with
    with منفعتش
    route model binding

update Method() 
payload الداتا اللي في الريكوست
الكويري استرينج او الbody اللي فيها بيانات
اي حاجه بتعمل راوت مودل بيندنج في الكنترورلر ده لازم يكون الايدي متشفر
الساعه 9:30 مهمه
تطبيق
---------------------------------------------------------------
status مبترجعش
    data from request return string '1'
    data from db return depend on datatype '1'
            (string)$product->status الحل
update Method
    1- validation request
    2- check image and update image
        if $request->has('image')
                remove the old image
                insert the new image
                update product in db 
        else update in db only
---------------------------------------------------------------
alert (delete متاكد؟)
---------------------------------

ازاي امسح تابل من الميجريشن (رول باك)
من الpending امسحه من visualstudio

====================================================================================
4/7/2023
---------
how to solve conflict local مهم
ADD specs
form repeater
create view product
عاوز اربط الspecname , spec value
    - هتدخل كل اسماء السبك في جدول الspecs
   - وقيمها فين product_specs 
   product controller مش مهمته يهندل السبكس
   http> services> specService.php
   handel specs
   assign specs to custom product
   هباصي السبكس من الريكوست الستور للسيرفيس
   dd($request)
    spec_names-> indexArray
    spec_names-> indexArray

    ممكن تدخل السبكس مره واحده ده غلط
    انا اعمل انسرت 3 مرات وكل مره اجيب ال id
        $savedIds=[];
    foreach ($specs as $spec){
        Spec::create(['name'=>$spec])
        $savedIds[] = $spec->id;
        }
        return $savedIds[];

حوار الترانسليشن هيبقي عندي 4 inputes 
وهظبط في الداتا بيز نوع السبكس json in 2 table
شكل الداتا اللي محتاجها الترانسلاتر بكدج

الفرونت يجبهالي جاهزه الاراي دي او انا اظبطها باك
    [
        'spec_names'=>[
            0=>[
                'en'=>'color',
                'ar'=>'عربي',
            ],

            1=>[
                'en'=>'material',
                'ar'=>'الخامه',
            ],
        ]
    ]

    هظبطها في جدول السبك والفنكشن الجافاسكريبت
واظبط في المودل انه ترانسليتبل ال name
package download(laravel 9) in laravel 10 مش لازم ننزلها
php artisan make:migration edit_name_column_in_specs_table
$table->json('name')->after('id')->change()
php artisan make:migration edit_value_column_in_product_spec_table
$table->json('value')->after('product_id')->change()
down هترجعه string('value',256)->change()
مشكله كل ما حد ياخد نسخه من الماستر ينزل تابل موجود فعلا الميديا
 
 هوه بيقرا البندينج من table migration 
مختلفين في الاسماء بسبب الوقت 
الحل تغير اسماء الجداول بالللي موجود في الميجريشن داتابيز في انكلود
php artisan migrate
// php artisan migrate rollback --step=2 هيرجعهالي استرينج
------------------------------------------------
 store()
 //savespecs 
 $product= new service او ابعتها dependency injection
 $specIds = $specService->saveNew($request->spec_names)

 array combine to اربط ال ids 
 idDatabase =>value 

 --------------
 service
 هحول الsavedIds to property

 public function matchIds(int $productId,array $specValue){
    forloop مهمه 10:17
    [
        [
            'product_id'=>$productId,
            'spec_id'=>$savedIds[0],
            'value'=>$specsValues[0],

        ]
    ]
 }

 saveProductSpecs ()
 هعمل لوب ع productSpecs 
ازاي ادخل داتا في الجدول الوسيط الmany to many
هدخلهم عن طريق specs or products
attach(fixed, [variable])

ابعتله البرودكت كبرامتر
$product->specs()->attach($this->productSpecs);

use trait translator in specs Model

--------------------------------------

هتظهرلي مشكله اني لما اجي ادخل الvalue لازم اعمل encode 
or
Make model to manytomany relationship
ProductSpec  
use trait, translatable value
في العلاقه ->using(ProductSpec)

-----------------------------------

1- savespecs
2- matchIds
3- saveProductSpecs
يا اما تخليهم ليهم علاقه ببعض او نربطهم ببعض
هنا في اعتماديه بسبب ال property اللي في السرفيس
هعمل return $this; في كل الميثود
---------------------------------------
او تغير الفانكشن تبقي بترجع حاجه واحده
هلغي ال 4this ---> local parameterبدالها 
static function


tasks:- 

in seller 
الغي ال chaining methods
الصوره تصغر 
multiple image
select2 with insert name
left to right
show view(specs , comment(دخل كذا واحده استاتيك بالداتا بيز))

admin dashboard
categories media
specs 
cities 
regions 



